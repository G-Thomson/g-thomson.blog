<!DOCTYPE html>
<html lang="en-us"><title>
    From Spreadsheet to Print Labels Using Python | 
    
    The Mindfield</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<meta name="description" 
      content="How I make labels for my seed packets
                ">

<link rel="canonical" href="/posts/spreadsheet-to-print-labels-in-python/" />

<link rel="icon" type="image/png" href="/image/favicon.ico">

<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/bulma.min.css">

<meta property="og:title" content="From spreadsheet to print labels using python" />
<meta property="og:description" content="How I make labels for my seed packets" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/spreadsheet-to-print-labels-in-python/" />
<meta property="article:published_time" content="2020-05-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-11T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="From spreadsheet to print labels using python"/>
<meta name="twitter:description" content="How I make labels for my seed packets"/>



    


<script src=/js/ramium.js></script>
<link rel="stylesheet" href=/css/ramium.css>





<body><nav class="navbar" style="background-color: #FFD653" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href=/>
      
      <strong>The Mindfield </strong>
      
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
      data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      
      
      <a class="navbar-item" href="https://g-thomson.com/">About me</a>
      
      
    </div>

    <div class="navbar-end">
      

      
    </div>
  </div>
</nav><div class="columns is-centered">
        <div id="page-body" class="column is-7">

<div class="content blog">
    <h1 class="title">From Spreadsheet to Print Labels Using Python</h1>

    <div id="infobar" class="level is-mobile">
        <div class="level-left">
            
            <div class="level-item">
                <p class="subtitle info date">May 11, 2020
                </p>
            </div>
            

            <div class="level-item">
                <p class="subtitle info">
                    4 mins read
                </p>
            </div>
        </div>
        <div class="level-right is-hidden-touch">
            <div class="tag-style">
                
                <a class="tag-style is-rounded" href="/tags/python">Python</a>
                
            </div>
        </div>
    </div>

    <div class="tag-style is-hidden-desktop">
        
        <a class="tag-style is-rounded" href="/tags/python">Python</a>
        
    </div> 

    <div class="blog-text">
        

        
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p>As a plant biologist I routinely generate a lot of seed from the plants I grow and study. Pricipally at the moment this is the seed of <em>Arabidopsis thaliana</em> which is very small. To keep on top of things I catalogue all my seeds and keep a spreadsheet of all my seed. The spreadsheet looks a little like this:</p>
<table class="table" style="font-size: 7px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sowing_number
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
Genotype
</th>
<th style="text-align:left;">
Vector
</th>
<th style="text-align:left;">
Date_harvested
</th>
<th style="text-align:left;">
Parent
</th>
<th style="text-align:left;">
Comment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A010
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
Ra-0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A011
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
Ct-1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A012
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
Mz-0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A014
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
HR-10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A015
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
NFA-10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A016
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
Gu-0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A018
</td>
<td style="text-align:left;">
Arabidopsis thaliana
</td>
<td style="text-align:left;">
Sq-8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
22/01/20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p><br/><br/>
This serves me well as a seed registry and corresponds to a box in my fridge where I have been storing the actual seed in 1.5 ml microcentrifuge tubes. Largly out of convinience as I use the tubes for everything and also because that is what I did in my previous lab where <em>A. thaliana</em> was not the main study system. However I’ve noticed that others in my lab store their <em>A. thaliana</em> seed in little paper packets which I think are more space efficient and may be a better storage environment if there is any moisture present. A fellow postdoc has made nice labels for all of their seed packets so I though I might too. Thus I set out to do just this!</p>
<p>Starting from my seed spreadsheet, which is accessible as a CSV file, I figured python would be a good tool to use and I found this neat open source library called <a href="https://github.com/Edinburgh-Genome-Foundry/blabel">blabel</a> which does what I want. Essentially I just have to load the CSV file, convert it to a list of dictionaries where each dictionary represents a row and blabel does the rest. It is very flexible as it takes a HTML file to determine the size and layout of the label and a CSS file is provided to style it. I generally follow the example style. The output is a label for each row as a page of a PDF. I wrapped this into a self contained python script I call <code>make_labels.py</code> (avaliable at the end of the post).</p>
<p>I can implement it like so:</p>
<pre class="bash"><code>python make_labels.py -i seed_data.csv</code></pre>
<p><img src="/posts/Spreadsheet-to-print-labels-in-python_files/label_demo.png" width="293" height="120" /></p>
<p>This is great! and produces a PDF with each page being a label. These are generally very small and I am sure they are very useful if you have a label printer. However I do not so I would like to aglomerate them all onto A4 pieces of paper I can print out, cut up and stick to my seed packets. This <a href="https://unix.stackexchange.com/questions/161715/combine-multiple-pdf-files-into-one-arranged-in-a-matrix">Stack Exchange question</a> led me to a shell script utility called <a href="https://github.com/DavidFirth/pdfjam">pdfjam</a> and I found that the deprecated <a href="https://github.com/DavidFirth/pdfjam-extras/blob/master/bin/pdfnup">pdfnup</a> script does what I’m after if I implement it like this:</p>
<pre class="bash"><code>bash pdfnup.sh output.pdf --nup 5x8</code></pre>
<p><img src="/posts/Spreadsheet-to-print-labels-in-python_files/label_demo2.png" width="290" height="209" /></p>
<p>This fits my needs as I usually harvest seeds in batches. I will need to test them out on the printer and maybe reduce the number on a page to avoid the margins but essentially from here on I can generate new labels as I need them by feeding the <code>make_labels.py</code> script new rows from my seed spreadsheet. I will then just stick them to the seed packets.</p>
<p>This is the <code>make_labels.py</code> script:</p>
<pre class="r"><code>#! /usr/bin/env python

import click
import pandas as pd
from blabel import LabelWriter

@click.command()
@click.option(&#39;-i&#39;, &#39;--input&#39;,  required=True, type=str, help=&quot;CSV file with columns that match the variables in the HTML template&quot;)
@click.option(&#39;-o&#39;, &#39;--output&#39;, default=&quot;output.pdf&quot;, type=str, help=&quot;Name of the output PDF&quot;)
@click.option(&#39;-t&#39;, &#39;--template&#39;, default=&quot;item_template.html&quot;, type=str, help=&quot;Name of the HTML template file&quot;, show_default=&quot;item_template.html&quot;)
@click.option(&#39;-s&#39;, &#39;--style&#39;, default=&quot;style.css&quot;, type=str, help=&quot;Name of the CSS file&quot;, show_default=&quot;style.css&quot;)

def write_labels(input, output, template, style):
    df = pd.read_csv(input)
    records = df.to_dict(&#39;records&#39;)

    label_writer = LabelWriter(template, default_stylesheets=(style,))
    label_writer.write_labels(records, target=output)     

if __name__ == &#39;__main__&#39;:
    write_labels()    </code></pre>
<p>This is the HTML file called <code>item_template.html</code>:</p>
<pre class="r"><code>&lt;span class=&#39;label&#39;&gt;
    Sowing number: {{ Sowing_number }} &lt;br/&gt;
    Genotype: {{ Genotype }}           &lt;br/&gt;
    Vector: {{ Vector }}               &lt;br/&gt;
    Comment: {{ Comment }}             &lt;br/&gt;
                                       &lt;br/&gt;
    Date harvested: {{ Date_harvested }}
&lt;/span&gt;</code></pre>
<p>This is the CSS <code>style.css</code> file:</p>
<pre class="r"><code>@page {
    width: 36mm;
    height: 14mm;
    padding: 0.5mm;
}
.label {
    font-family: Verdana;
    font-weight: bold;
    vertical-align: middle;
    display: inline-block;
    font-size: 7px;
}</code></pre>

    </div>
</div>


<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </div>
    </div>

<footer class="footer has-background-dark">
    <div class="content has-text-centered has-text-white">
        <p>
            © 2020 Ramium. Powered by
            <a class="has-text-light" href="https://github.com/gohugoio/hugo" target="_blank">
            Hugo</a>. Theme
            <a class="has-text-light" href="https://github.com/rafed123/ramium/" target="_blank">
                Ramium.
            </a>
        </p>
    </div>
</footer>
</body>

</html>